#!/bin/bash

# Input file
input_file="input.txt"

# Output file
output_file="output.txt"

# Pattern to match
pattern="your_pattern"

awk -v pat="$pattern" '
BEGIN {
    delete_above = 0; delete_below = 0;
}
{
    if (delete_above) {
        # Stop deleting above if a blank line is encountered
        if ($0 == "") {
            delete_above = 0;
        } else {
            next;
        }
    }

    # Check for the match
    if ($0 ~ pat) {
        # Look ahead for blank lines after the match
        getline next_line;
        if (next_line == "") {
            # No other non-blank content after: delete surrounding lines
            delete_above = 1; delete_below = 1;
            next;
        } else {
            # Non-blank line found after: only delete the match
            print next_line;
            next;
        }
    }

    if (delete_below) {
        # Stop deleting below if a blank line is encountered
        if ($0 == "") {
            delete_below = 0;
        }
        next;
    }

    # Print lines that are not marked for deletion
    print;
}
' "$input_file" > "$output_file"

echo "Processed file saved as $output_file"
